<div style="padding: 30px 20px">
  <!-- TÍTULO DA PÁGINA -->
  <div class="page__header">
    <div class="title-page-section">
      <span class="title-page">Gerenciar</span>
      <span class="title-page title-page--2nd-line">Produtos</span>
    </div>
    <i aria-hidden="true" class="fas fa-box-open title-page-icon"></i>
  </div>

  <!-- FILTROS E BOTÕES -->
  <div style="margin-bottom: 15px">
    <div class="header-actions row" id="header-actions">

      <!-- Título -->
      <mat-form-field class="col s12s m6s l3s xl3s">
        <mat-label>Título</mat-label>
        <input [(ngModel)]="textSearch" matInput
               maxlength="100" type="text">
      </mat-form-field>

      <!-- Data de início de cadastro -->
      <mat-form-field class="col s12s m6s l3s xl3s">
        <mat-label>Início do cadastro</mat-label>
        <input [matDatepicker]="picker1" matInput>
        <mat-datepicker-toggle [for]="picker1" matSuffix></mat-datepicker-toggle>
        <mat-datepicker #picker1></mat-datepicker>
      </mat-form-field>

      <!-- Data final de cadastro -->
      <mat-form-field class="col s12s m6s l3s xl3s">
        <mat-label>Fim do cadastro</mat-label>
        <input [matDatepicker]="picker2" matInput>
        <mat-datepicker-toggle [for]="picker2" matSuffix></mat-datepicker-toggle>
        <mat-datepicker #picker2></mat-datepicker>
      </mat-form-field>

      <!-- Categorias -->
      <mat-form-field class="col s12s m6s l3s xl3s">
        <mat-label>Categorias</mat-label>
        <mat-select [formControl]="controlCategories" multiple>
          <mat-option *ngFor="let categ of categories" [value]="categ.id">{{categ.nome}}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="actions-btn">
      <button (click)="createProduct()" class="action-btn__item btn-focus--grey col s6 m6 l6 xl6"
              mat-raised-button>
        <mat-icon>add</mat-icon>
        Novo produto
      </button>

      <!-- TODO: Continuar funcionalidade -->
      <button class="action-btn__item btn-focus--grey col s6 m6 l6 xl6" mat-raised-button>
        <mat-icon>attach_money</mat-icon>
        Alterar preço
      </button>
    </div>
  </div>

  <!-- TABELA -->
  <table [dataSource]="dataSource" class="mat-elevation-z8" mat-table matSort>

    <!-- CHECKBOX -->
    <ng-container matColumnDef="select">
      <th *matHeaderCellDef mat-header-cell>
        <mat-checkbox (change)="$event ? masterToggle() : null"
                      [checked]="selection.hasValue() && isAllSelected()"
                      [indeterminate]="selection.hasValue() && !isAllSelected()">
        </mat-checkbox>
      </th>
      <td *matCellDef="let row" mat-cell>
        <mat-checkbox (change)="$event ? selection.toggle(row) : null"
                      (click)="$event.stopPropagation()"
                      [checked]="selection.isSelected(row)">
        </mat-checkbox>
      </td>
    </ng-container>

    <!-- ID -->
    <ng-container matColumnDef="id">
      <th *matHeaderCellDef mat-header-cell mat-sort-header>Id</th>
      <td *matCellDef="let p" mat-cell>{{p.id}}</td>
    </ng-container>

    <!-- TITULO -->
    <ng-container matColumnDef="titulo">
      <th *matHeaderCellDef mat-header-cell mat-sort-header>Título</th>
      <td *matCellDef="let p" mat-cell>{{p.titulo}}</td>
    </ng-container>

    <!-- PORCENTAGEM DE DESCONTO -->
    <ng-container matColumnDef="porcentDesc">
      <th *matHeaderCellDef mat-header-cell mat-sort-header>Desconto</th>
      <td *matCellDef="let p" mat-cell>
        <span *ngIf="p.porcentDesc">{{p.porcentDesc | number: '1.0-2'}}%</span>
      </td>
    </ng-container>

    <!-- PREÇO -->
    <ng-container matColumnDef="preco">
      <th *matHeaderCellDef mat-header-cell mat-sort-header>Preço</th>
      <td *matCellDef="let p" mat-cell>{{p.preco | currency: 'BRL'}}</td>
    </ng-container>

    <!-- FRETE GRÁTIS -->
    <ng-container matColumnDef="freteGratis">
      <th *matHeaderCellDef mat-header-cell mat-sort-header>Frete grátis</th>
      <td *matCellDef="let p" mat-cell>{{p.freteGratis}}</td>
    </ng-container>

    <!-- QTD DISPONÍVEL -->
    <ng-container matColumnDef="qtdDisponivel">
      <th *matHeaderCellDef mat-header-cell mat-sort-header>Unidades disponíveis</th>
      <td *matCellDef="let p" mat-cell>{{p.qtdDisponivel}}</td>
    </ng-container>

    <!-- CATEGORIAS -->
    <ng-container matColumnDef="categorias">
      <th *matHeaderCellDef mat-header-cell mat-sort-header>Categorias</th>
      <td *matCellDef="let p" mat-cell>
        <ul *ngIf="p.categorias" style="padding-inline-start: 20px;">
          <li *ngFor="let categ of p.categorias">{{categ.nome}}</li>
        </ul>
      </td>
    </ng-container>

    <tr *matHeaderRowDef="displayedColumns" mat-header-row></tr>
    <tr (click)="selectProduct(row.id)" *matRowDef="let row; columns: displayedColumns;" mat-row>
    </tr>
  </table>
</div>
